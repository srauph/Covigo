{% extends 'Covigo/base.html' %}

{% block script %}
    <script>
        let alert_del = document.querySelectorAll('.alert-del');
        alert_del.forEach(
            (x) => x.addEventListener(
            'click',
            function(){
                x.parentElement.classList.add('hidden')
            }
            )
        );
    </script>
{% endblock %}

{% block content %}
    <div class="min-h-full bg-slate-100">
        <div class="flex justify-between bg-slate-700">
            <h1 class="text-2xl text-white font-semibold px-8 py-4">
                Symptoms
            </h1>
        </div>

        <div class="bg-white shadow m-8 rounded-xl">
            <div class="w-full flex flex-wrap justify-end p-4 gap-2">
                <div>
                    {# TODO: Filters should go HERE #}
                    <form action="" class="flex justify-between items-center gap-2">
                        <input name="" id="" class="bg-slate-100 border border-slate-400 h-8 text-sm text-black px-2 rounded-md"
                               placeholder="Search by Symptom...">
                        <button class="bg-green-600 hover:bg-green-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                            <span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                            </span>
                            <span>
                                Search
                            </span>
                        </button>
                    </form>
                </div>
                <div class="flex flex-auto justify-end gap-2">

                    {# clicking on this button creates a GET request and redirects the user to the "Create Symptom" page #}
                    <a href="{% url 'symptoms:create_symptom' %}">
                        <button class="bg-green-600 hover:bg-green-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                            <span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                     stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </span>
                            <span>
                                New Symptom
                            </span>
                        </button>
                    </a>
                </div>
            </div>
        </div>

        {% for message in messages %}
            {% if message.tags == 'success'%}
                <div role="alert" class="p-5 rounded-lg border m-8 border-green-400 bg-green-300 text-green-900">
                    <div class="alert-del divide-y-2 divide-solid divide-green-400">
                        <h2 class="font-bold text-xl flex items-center pb-2">
                            <span class="mr-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                                </svg>
                            </span>
                            Success!
                            <div class="text-xl flex align-center w-full justify-end">
                                <strong class="cursor-pointer">
                                    &times;
                                </strong>
                            </div>
                        </h2>
                        <p class="pt-2">
                            {{ message }}
                        </p>
                    </div>
                </div>
            {% endif %}
        {% endfor %}

        <div class="m-4 justify-evenly gap-4">
            <div class="m-4 p-4 bg-white shadow rounded-lg">
                <table class="w-full table-auto" id="user_list_table">
                    <thead>
                    <tr class="border-b">
                        <th class="p-2 text-left">
                            Name
                        </th>
                        <th class="p-2 text-left">
                            Description
                        </th>
                        <th class=></th>
                    </tr>
                    </thead>
                    <tbody>

                    {# this for loop will check for every symptom present in the database and display/return all of them in table/row form to generate the list of symptoms on the view #}
                    {% for symptom in symptoms %}
                            <tr class="hover:bg-gray-200">
                                <td name="Symptom Name" class="p-2">
                                    {{ symptom.name }}
                                </td>
                                <td name="Symptom Description" class="p-2">
                                    {{ symptom.description }}
                                </td>
                                <td class="p-2 text-center flex flex-wrap justify-center sm:justify-end gap-2">
                                    <a href="{% url 'symptoms:toggle_symptom' symptom.id %}">
                                        {% if symptom.is_active %}
                                            <button class="bg-red-600 hover:bg-red-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                                                <span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                    </svg>
                                                </span>
                                                Disable
                                            </button>
                                        {% else %}
                                            <button class="bg-blue-600 hover:bg-blue-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                                                <span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                    </svg>
                                                </span>
                                                Enable
                                            </button>
                                        {% endif %}
                                    </a>

                                    {# if this button is chosen/clicked, the specific symptom associated with it will be fetched from the database using the symptom id, at which point the view will redirect the user to the "Edit Symptom" page and allow them to edit the symptom details of that symptom before submitting the form change/update back to the database to be reflected on the view of this page #}
                                    <a href="{% url 'symptoms:edit_symptom' symptom.id %}">
                                        <button class="bg-blue-600 hover:bg-blue-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                                     viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                          d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                </svg>
                                            </span>
                                            <span>
                                                Edit
                                            </span>
                                        </button>
                                    </a>
                                </td>
                            </tr>
                        {% endfor %}
                        {% for group in groups  %}
                                <td class="p-2 flex justify-end items-center gap-2">
                                    <a href="{% url 'accounts:edit_group' group.id %}">
                                        <button class="bg-blue-600 hover:bg-blue-800 text-sm font-semibold text-white px-2 py-1 rounded-md flex items-center gap-1">
                                            <span>
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                                     viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                          d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                                </svg>
                                            </span>
                                            <span>
                                                Edit
                                            </span>
                                        </button>
                                    </a>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}